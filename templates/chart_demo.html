<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
  <link rel="stylesheet" href="/media/css/main.css" type="text/css"
        media="screen" charset="utf-8"> 
  <script src="/media/js/raphael-min.js"
          type="text/javascript" charset="utf-8"></script> 
  <script src="/media/js/g.raphael-min.js"
          type="text/javascript" charset="utf-8"></script> 
  <script src="/media/js/g.pie-min.js" type="text/javascript"
          charset="utf-8"></script> 
  <script src="/media/js/g.bar.patched.js" type="text/javascript"
          charset="utf-8"></script> 
  <script type="text/javascript" charset="utf-8"> 
    window.onload = function () {
    var r = Raphael("pie-chart");
    r.g.txtattr.font = "12px 'Fontin Sans', Fontin-Sans, sans-serif";    
    r.g.text(320, 100, "Interactive Pie Chart").attr({"font-size": 20});
    var pie = r.g.piechart(320, 240, 100, 
    {{ data.values }},
    { legend: [
    {% for label in data.keys %}
    "{{ label }} (%%)",
    {% endfor %}
    ],
    legendpos: "west", 
    href: ["/", "/"]
    });

    pie.hover(function () {
    this.sector.stop();
    // first two args to scale() are the scaled size. 
    this.sector.scale(1.01, 1.01, this.cx, this.cy);
    if (this.label) {
    this.label[0].stop();
    this.label[0].scale(1.5);
    this.label[1].attr({"font-weight": 800});
    }
    }, function () {
    this.sector.animate({scale: [1, 1, this.cx,
    this.cy]}, 500, "bounce");
    if (this.label) {
    this.label[0].animate({scale: 1}, 500,
    "bounce");
    this.label[1].attr({"font-weight": 400});
    }
    });    

    var b = Raphael("bar-chart");
    b.g.txtattr.font = "12px 'Fontin Sans', Fontin-Sans, sans-serif";    
    b.g.text(320, 100, "Brisket Bar Chart").attr({"font-size": 20});

    var fin = function () {
    this.flag = r.g.popup(this.bar.x, this.bar.y,this.bar.value || "0").insertBefore(this);
    };

    var fout = function () {
    this.flag.animate({opacity: 0}, 300, function () { this.remove();});
    };

    labels = [];
    {% for x in bar_data %}
    labels.push("{{ x.category_name }}");
    {% endfor %}

    var data = [
    {% for x in bar_data %}
    {{ x.amount }},
    {% endfor %}
    ]; 

    opts = {
    "type": "soft",
    "stacked": true
    };

    barchart = b.g.hbarchart(10,10, 250, 200, data, opts);
    barchart.label(labels);    

    // end window.onload();
    };
  </script> 
</head> 
<body>
  <div id="pie-chart"></div> 
  <div id="bar-chart"></div> 
</body> 
</html>
