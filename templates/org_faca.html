{% load humanize %}
{% load influence_extras %}

<div class="overviewBar">
  <a class="toggle">Toggle</a>
  <h3 class="insideBar">{{ section.name }}</h3>
      <div class="insideBar amount">
          <a class="descriptor" title="More Information" href="#regulationsDescriptor">Information</a>
          <div class="clear"></div>      
          <div class="descriptorText" id='facaDescriptor'>
            <p>Methodology goes here.</p>
          </div>      
    </div>
</div>

<div class="chartModule">

{% if section.faca %}
      <ul class="expandTableHead">
          <li class="expandCol toggle noshow"></li>
          <li class="expandCol facaColLarge">Agency</li>
          <li class="expandCol facaColLarge">Representation</li>
      </ul>
      <ul class='expandTable clear' id="faca" data-expand-url='{{ AGGREGATES_API_BASE_URL }}aggregates/org/{{ entity_info.id }}/faca/{id}.json?apikey={{ API_KEY }}&cycle={{cycle}}&callback=?' data-expand-template="#facaPopDownTemplate">
            {% for row in section.faca %}
            <li class="{% cycle 'even' 'odd' %} expandTableRow" data-expand-id="{{ row.agency_abbr }}">
                <a class="expandCol toggle">Toggle</a>
                <span class="expandCol facaColLarge">{{ row.agency_name }}</span>
                <span class="expandCol facaColLarge">
                    {{ row.member_count }} {{ row.member_count|pluralize:'person,people' }} on {{ row.committee_count }} committee{{ row.committee_count|pluralize }}
                </span>
                <div class="clear"></div>
                <div class="loading"></div>
                <div class="expandDocList"></div>
            </li>
            {% endfor %}
      </ul>
    {% endif %}
  </div>

<script type="text/html" id="facaPopDownTemplate">
<table>
  <tbody>
  <% for (var i = 0; i < documents.length; i++) { %>
    <tr class="<%=(i % 2 == 0 ? 'even' : 'odd')%>">
      <td>
        <strong><%=documents[i].committee_name%></strong><br />
        <strong>Members:</strong>
        <% for (var j = 0; j < documents[i].memberships.length; j++) { %>
          <%=documents[i].memberships[j].member_name%> (<%=documents[i].memberships[j].affiliation%>, <%=documents[i].memberships[j].start_date.split("-")[0]%>&ndash;<%=documents[i].memberships[j].end_date.split("-")[0]%>)<% if (j != documents[i].memberships.length - 1) { %>, <% } %>
        <% } %>
      </td>
    </tr>
  <% } %>
  </tbody>
</table>
</script>