{% extends "base.html" %}

{% block extrajs %}
<script type="text/javascript" charset="utf-8"> 
  window.onload = function () {
  piechart("piechart_level", {{ level_breakdown|safe }}, "State vs. Federal");
  piechart("piechart_party", {{ party_breakdown|safe }}, "Republicans vs. Democrats");  
  barchart("recipients_barchart", {{ recipients_barchart_data|safe }}, "Top Recipients");  
  }
</script>

{% endblock %}


{% block main %}

<h1>{{ entity_info.name }}</h1>

<div id="biographical">
  <div id="organization_picture_frame">
    <img src="/media/images/placeholder_483px.png" id="organization_logo">
  </div>
  <div id="organization_metadata">
    <h3>{{ entity_info.name }}</h3>
    <p>Description description description chicken description bbq
    description sauce description sautee description stirfry
    description vegetables description tofu description.</p>
  </div>
  <div id="cycle_filter">
    <h3>View Other Selection Cycles</h3>
    <p>Select another election cycle to change the charts below</p>
    <form action="" method="get">
      {{ cycle_form.as_p }}
      <input type="submit" value="Update Cycles" />
    </form>
  </div>
</div>

<div id="totals_section">
  <span id="amount_given">
    ${{entity_info.contribution_total_given }} Given as of 
    [[ date ]]
  </span>
  <span id="sparkline_given">
    {% if sparkline %} 
    <img src="{{ sparkline }}">
    {% else %}
    <b>Sparkline: No Data</b>
    {% endif %}
  </span>
  <a href="{{ entity_info.name|slugify }}/{{ entity_id }}/details">View Details</a>
</div>

<div id="charts">
  <div id="recipients_barchart">
    <!-- raphael charts here -->
  </div>

  <div class="piechart">
    <div id="piechart_party">      
      <!-- raphael charts here -->
    </div>
  </div>

  <div class="piechart">
    <div id="piechart_level">
      <!-- raphael charts here -->
    </div>
  </div>
</div>

<div class="lobbying_data">
  {% if lobbying_spent_by_industry %}
  <h2>Lobbying</h2>
  <!-- tuples contain (industry_code, industry_name, --
    -- industry_area, amt) -->
  <div id="lobbying_summary">
    {{ entity_info.name }} spent
    {% for industry in lobbying_spent_by_industry %}
    ${{ industry.3 }} on lobbyists in <a href="/lobby/{{industry.0}}">{{ industry.2|title }}</a> 
    (<a href="">{{ industry.1|title }}</a>). 
    {% endfor %}
  </div>
  <div id="lobbying_table">
    <table>
      <thead>
	<tr>
	  <th>Firm</th>
	  <th>Amount</th>
	</tr>
      </thead>
      <tbody>
	{% for row in lobbying_by_firm %}
	<tr>
	  <td><a href="/search?query={{ row.0|urlencode }}">{{ row.0 }}</a></td>
	  <td>${{ row.1 }}</td>
	</tr>
	{% endfor %}
      </tbody>
    </table>
  </div>  

  {% else %}
  <em>There is no record of {{ entity_info.name }} hiring lobbyists during {{ cycle }}.</em><br>
  {% endif %}



  {% if lobbying_hired_for_by_industry %}
  <!-- tuples contain (industry_code, industry_name, --
    -- industry_area, amt) -->
  <div id="lobbying_summary">
    {{ entity_info.name }} received
    {% for industry in lobbying_hired_for_by_industry %}
    ${{ industry.3 }} to lobby for <a href="/lobby/{{industry.0}}">{{ industry.2|title }}</a> 
    (<a href="">{{ industry.1|title }}</a>). 
    {% endfor %}
  </div>
  <div id="lobbying_table">
    <table>
      <thead>
	<tr>
	  <th>Customer</th>
	  <th>Amount</th>
	</tr>
      </thead>
      <tbody>
	{% for row in lobbying_by_customer %}
	<tr>
	  <td><a href="/search?query={{ row.0|urlencode }}">{{ row.0 }}</a></td>
	  <td>${{ row.1 }}</td>
	</tr>
	{% endfor %}
      </tbody>
    </table>
  </div>  

  {% else %}
  <em>There is no record of {{ entity_info.name }} being hired as a lobbyist during {{ cycle }}.</em><br>
  {% endif %}

  
</div>

{% endblock %}
