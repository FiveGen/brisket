{% extends "entity_base.html" %}
{% load humanize %}
{% block body_class %}organization{% endblock %}

{% block extrajs %}
<script type="text/javascript" charset="utf-8"> 
$(document).ready(function() {
  piechart("piechart_level", {{ level_breakdown|safe }});
  piechart("piechart_party", {{ party_breakdown|safe }}, type="party" );  
  barchart("recipients_barchart", {{ recipients_barchart_data|safe }});  
  sparkline("sparklines", {{ sparkline_data|safe }});
});
</script>
{% endblock %}

{% block contentHeader %}
<h2>{{ entity_info.name }}</h2>
{% endblock %}

{% block contrib_overview_amount %}
{% if entity_info.totals.contributor_amount %}
${{entity_info.totals.contributor_amount|floatformat:-1|intcomma }} Given
{% endif %}
{% endblock %}

{% block charts %}

<div class="twoColumn chartWrapper"> 
  <div class="chart"> 
    <h4>Top Recipients</h4>
    <div class="graph" id="recipients_barchart">
      <!-- raphael charts here -->
    </div>    
  </div>
</div>

<div class="oneColumn chartWrapper">
  <div class="chart">
    <h4 class="withTip">Republicans vs. Democrats</h4>
    <span class="tip">in dollars</span>
    <div class="graph" id="piechart_party">
      <!-- raphael charts here -->
    </div>
  </div>
</div>

<div class="oneColumn chartWrapper">
  <div class="chart">
    <h4 class="withTip">State vs. Federal</h4>
    <span class="tip">in dollars</span>
    <div class="graph" id="piechart_level">
      <!-- raphael charts here -->
    </div>
  </div>
</div>

{% endblock %}

{% block external_contrib_links %}  
{% if external_links %}
Get more information on contributions: 
{% for link in external_links %}
<a href="{{ link.1 }}" class="external">{{ link.0 }}</a>
{% endfor %}
{% endif %}
{% endblock %}
 
{% if lobbying_for_org or lobbying_by_org %}

{% block lobbying_hired_amount %}
{% if entity_info.totals.client_amount %} 
    ${{ entity_info.totals.client_amount|floatformat:-1|intcomma }} hired
{% endif %}
{% endblock %}

{% block lobbying_executed_amount %}
{% if entity_info.totals.registrant_amount %} 
   ${{ entity_info.totals.registrant_amount|floatformat:-1|intcomma }} executed
{% endif %}
{% endblock %}

{% block lobbying_tables %}

{% if lobbying_for_org %}
<div class="threeColumn chartWrapper">
    <h4>Lobbying On Behalf of {{ entity_info.name }}</h4>
    
    <div class="lobbyingColumn oneColumn chartWrapper">
        {% if lobbyists_on_behalf_of_org %}
        <div class="lobbyistsOrgs oneColumn chartWrapper">
            <span class="secondaryTitle">Lobbied for this Organization's Issues</span>:
            <ul>
                {% for row in lobbyists_on_behalf_of_org %}
                {% if row.lobbyist_entity %}
                <li>
                    <a href="/individual/{{ row.lobbyist_name|slugify }}/{{ row.lobbyist_entity }}?cycle={{cycle}}">{{ row.lobbyist_name }}</a>
                </li>
                {% else %}
                {{ row.lobbyist_name }}
                {% endif %}
                {% endfor %}
            </ul>
        </div>
        {% endif %}
        
        {% if issues_lobbied_for %}
        <div class="issuesLobbied oneColumn">
            <span class="secondaryTitle">Issues Lobbied:</span>
            <ul>
	      {% for issue in issues_lobbied_for %}
	      <li>
		{{issue}}{% if forloop.last %}{% else %},{% endif %}
	      </li>
	      {% endfor %}
            </ul>
        </div>
        {% endif %}
    </div>
    
    <table class="twoColumn">
        <thead>
            <tr id="titles">
                <th class="left">Firm Hired</th>
                <th class="right">Amount</th>
            </tr>
        </thead>
        <tbody>
            {% for row in lobbying_for_org %}
            <tr class="{% cycle 'even' 'odd' %}">
                <td>	    
                    {% if row.registrant_entity %}
                    <a href="/organization/{{ row.registrant_name|slugify }}/{{ row.registrant_entity }}?cycle={{cycle}}">{{ row.registrant_name }}</a>
                    {% else %}
                    {{ row.registrant_name }}
                    {% endif %} 
                </td>
                <td class="right">${{ row.amount|floatformat:-1|intcomma }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    <div class="clear"></div>
</div>
{% endif %}

{% if lobbying_by_org %}
<div class="threeColumn chartWrapper">
    <h4>Lobbying Carried Out by {{ entity_info.name }}</h4>
    <div class="lobbyingColumn oneColumn">
        {% if lobbyists_as_employees_of_org %}
        <div class="lobbyistsOrgs chartWrapper">
            <span class="secondaryTitle">Lobbyists Employed by this Organization:</span>
            <ul>
                {% for row in lobbyists_as_employees_of_org %}
                {% if row.lobbyist_entity %}
                <li>
                    <a href="/individual/{{ row.lobbyist_name|slugify }}/{{ row.lobbyist_entity }}?cycle={{cycle}}">{{ row.lobbyist_name }}</a>
                </li>
                {% else %}
                {{ row.lobbyist_name }}
                {% endif %}
                {% endfor %}
            </ul>
            <div class="clear"></div>
        </div>
        {% endif %}
    
        {% if issues_lobbied_by %}
        <div class="issuesLobbied">
            <span class="secondaryTitle">Issues Lobbied:</span>  
            <ul> 
	      {% for issue in issues_lobbied_by %}
	      <li>
		{{issue}}{% if forloop.last %}{% else %},{% endif %}
	      </li>
	      {% endfor %}
            </ul>
        </div>
        {% endif %}
    </div>

    <table class="twoColumn">
        <thead>
            <tr id="titles">
                <th class="left">Customer</th>
                <th class="right">Amount</th>
            </tr>
        </thead>
        <tbody>
            {% for row in lobbying_by_org %}
            <tr class="{% cycle 'even' 'odd' %}">
                <td>	    
                    {% if row.client_entity %}
                    <a href="/organization/{{ row.client_name|slugify }}/{{ row.client_entity }}?cycle={{cycle}}">{{ row.client_name }}</a>
                    {% else %}
                    {{ row.client_name }}
                    {% endif %} 
                </td>
                <td class="right">${{ row.amount|floatformat:-1|intcomma }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    
    <div class="clear"></div>
</div>
{% endif %}

{% endblock %}

{% else %}

{% endif %} <!-- endif there is lobbying data -->
