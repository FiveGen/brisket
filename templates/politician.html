{% extends "base.html" %}

{% block extrajs %}
<script type="text/javascript" charset="utf-8"> 
  window.onload = function() {
  piechart("piechart_local", {{ local_breakdown|safe }}, "In State vs. Out of State");
  piechart("piechart_entity", {{ entity_breakdown|safe }}, "Individuals vs. PACs");
  barchart("sectors_barchart", {{ sectors_barchart_data|safe }}, "Industry Sectors");
  }
</script>

{% endblock %}

{% block main %}

<h1>{{ entity_info.name }}</h1>
    {% if metadata.party == 'D' %}
       Democratic Party:     
    {% else %} 
       {% if metadata.party == 'R' %}    
          Republican Party:
       {% else %}
          {{ metadata.party }}
       {% endif %}
    {% endif %}
    {{ metadata.state }}

<div id="biographical">
  <div id="politician_picture_frame">
    <img src="{{ metadata.photo_url }}" id="politician_picture">
  </div>
  <div id="politician_metadata">   
    {{ metadata.biography }}
  </div>
  <div id="cycle_filter">
    <h3>View Other Selection Cycles</h3>
    <p>Select another election cycle to change the charts below</p>
    <form action="" method="get">
      {{ cycle_form.as_p }}      
      
      <input type="submit" value="Update Cycles" />
    </form>
  </div>
</div>

<div id="totals_section">
  <span id="amount_received">
    ${{entity_info.contribution_total_received }} Received as of 
    [[ date ]]
  </span>
  <span id="sparkline_received">
    {% if sparkline %} 
    <img src="{{ sparkline }}">
    {% else %}
    <b>Sparkline: No Data</b>
    {% endif %}
  </span>
  <a href="{{ entity_info.name|slugify }}/{{ entity_id }}/details">View Details</a>
</div>

<div id="charts">
  <div id="sectors_barchart">
      <!-- raphael charts -->
  </div>

  <div class="piechart">
    <div id="piechart_local">            
      <!-- raphael charts -->
    </div>
  </div>

  <div class="piechart">
    <div id="piechart_entity">
      <!-- raphael charts -->
    </div>
  </div>
</div>

<div id="top_contributors">
  <h2>Top Contributors to {{ entity_info.name }}</h2>
  <table>
    <thead>
      <tr>
	<th>Name</th>
	<th>Direct<br>Contributions</th>
	<th>Employee<br>Contributions</th>
	<th>Total</th>
      </tr>
    </thead>
    <tbody>
      {% for row in top_contributors %}
      <tr>
	{% if row.id %}
	<td><a href="/organization/{{ row.name|slugify }}/{{ row.id }}">{{ row.name }}</a></td>
	{% else %}
	<td>{{ row.name }}</td>
        {% endif %} 
	<td>{{ row.direct_amount }} </td>
	<td>{{ row.employee_amount }}</td>
	<td>{{ row.total_amount }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<div id="capitol_words">
  {% for item in capitol_words %}
  <b>{{item.word}}: </b>{{item.word_count}}<br>
  {% endfor %}
</div>

{% endblock %}
