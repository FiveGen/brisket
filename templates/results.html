{% extends "search_base.html" %}
{% load humanize %}
{% load influence_extras %}

{% block main %}

<div id="contentHeader">
  {% if not sorted_results %}
  <h2>No results for that search</h2>
  {% else %}
  <h2>Results for &#8220;{{ query|title }}&#8221;</h2>

</div>


<div class="module">
  <div id="description">
      <p>
      Influence Explorer uses disclosure data to identify
      the largest donors to all federal and state politicians, PACs
      and political parties and the biggest spenders on Washington
      lobbyists.
      </p>
      <p>
      If you can’t find the organization or individual
      you’re looking for here, try searching           
      <a href="http://transparencydata.com">TransparencyData.com</a>.
      </p>
  </div>

  {% if num_orgs %}
  <div class="searchBox">
    <h3>Matching Organizations</h3>
    <span class="results">{{ num_orgs }} Result{{num_orgs|pluralize}}</span>
      <table class="threeColumn clear">
          <thead>
              <tr id="titles">
                  <th class="left">Name</th>
                  <th class="right">Lobbying Spending</th>
                  <th class="right">Campaign Contributions</th>
              </tr>
          </thead>
          <tbody>
          {% for result in sorted_results.organization %}
              <tr class="{% cycle 'even' 'odd' %}">
                  <td class="left">
                      <a href="/{{ result.type }}/{{result.name|standardize_organization_name|slugify }}/{{ result.id }}?cycle={{cycle}}">{{result.name|standardize_organization_name}}</a>
                      <span class="transactions" title="Results">
                      {{result.count_lobbied|add:result.count_given}}
                      transaction{{result.count_lobbied|add:result.count_given|pluralize }} </span>
                  </td>
                  <td class="right">{% if result.non_firm_spending %}${% endif %}{{ result.non_firm_spending|floatformat:0|intcomma }}</td>
                  <td class="right">${{ result.total_given|floatformat:0|intcomma }}</td>
              </tr>
          {% endfor %}
          </tbody>
      </table>
  </div>
  {% endif %}

  {% if num_firms %}
  <div class="searchBox">
    <h3>Matching Lobbying Firms</h3>
    <span class="results">{{ num_firms }} Result{{num_firms|pluralize}}</span>
      <table class="threeColumn clear">
          <thead>
              <tr id="titles">
                  <th class="left">Name</th>
                  <th class="right">Lobbying Income</th>
                  <th class="right">Campaign Contributions</th>
              </tr>
          </thead>
          <tbody>
          {% for result in sorted_results.lobbying_firm %}
              <tr class="{% cycle 'even' 'odd' %}">
                  <td class="left">
                      <a href="/{{ result.type }}/{{result.name|standardize_organization_name|slugify }}/{{ result.id }}?cycle={{cycle}}">{{result.name|standardize_organization_name}}</a>
                      <span class="transactions" title="Results">
                      {{result.count_lobbied|add:result.count_given}}
                      transaction{{result.count_lobbied|add:result.count_given|pluralize }} </span>
                  </td>
                  <td class="right">${{ result.firm_income|floatformat:0|intcomma }}</td>
                  <td class="right">{% if result.total_given %}${% endif %}{{ result.total_given|floatformat:0|intcomma }}</td>
              </tr>
          {% endfor %}
          </tbody>
      </table>
  </div>
  {% endif %}

  {% if num_indivs %}
  <div class="searchBox clear">
    <h3>Matching People</h3>
    <span class="results">{{ num_indivs }} Result{{num_indivs|pluralize}}</span>
    <ul>
        {% for result in sorted_results.individual %}
        <li class="{% cycle 'even' 'odd' %}">
            <a href="/{{ result.type }}/{{ result.name|standardize_individual_name|slugify }}/{{ result.id }}?cycle={{cycle}}">{{result.name|standardize_individual_name}}</a>
            <span class="transactions" title="Results">
            {{result.count_given}}
            transaction{{result.count_given|pluralize }} </span>
            <span class="amountGiven">${{ result.total_given|floatformat:0|intcomma }} Given</span>
            <div class="clear"></div>
        </li>
        {% endfor %}
    </ul>
  </div>
  {% endif %}


  {% if num_pols %}
  <div class="searchBox clear">
      <h3>Matching Politicians</h3>
      <span class="results">{{ num_pols }} Result{{num_pols|pluralize}}</span>
      <table class="threeColumn clear">
          <thead>
              <tr id="titles">
                  <th class="left">Politician</th>
                  <th class="center">State</th>
                  <th class="center">Office</th>
                  <th class="center">Party</th>
                  <th class="center">Total Received</th>
                  <th class="right">Records</th>
              </tr>
          </thead>
          <tbody>
              {% for result in sorted_results.politician %}
              <tr class="{% cycle 'even' 'odd' %}">
                  <td class="left lawmakerName">
                      <a href="/{{ result.type }}/{{ result.name|standardize_politician_name|slugify }}/{{ result.id }}?cycle={{cycle}}">{{result.name|standardize_politician_name}}</a>
                  </td>
                  <td class="center">{{ result.state }}</td>
                  <td class="center">{{ result.seat|seat_label }}</td>
                  <td class="center">{{ result.party }}</td>
                  <td class="center">${{result.total_received|floatformat:0|intcomma }}</td>
                  <td class="right">{{ result.count_received }}</td>
                  {% endfor %}
              </tr>
          </tbody>
      </table>
  </div>
  <div class="twoColumn chartWrapper">
    <div class="clear">
    </div>
  </div>
  {% endif %}

</div>

{% endif %}

{% endblock %}
